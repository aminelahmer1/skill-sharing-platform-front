<!-- conversation-header.component.html - VERSION CORRIGÃ‰E -->
<header class="conversation-header">
  <div class="header-left">
    <div class="header-avatar">
      <img [src]="getConversationAvatar()" [alt]="conversation.name">
      <span class="status-dot" 
            *ngIf="conversation.type === 'DIRECT' && conversation.participants.length > 0"
            [class.online]="getOtherParticipant()?.isOnline">
      </span>
    </div>
    
    <div class="header-info">
      <h3 class="conversation-title">
        <span class="conversation-icon">{{ getConversationIcon() }}</span>
        {{ getConversationName() }}
      </h3>
      <span class="conversation-subtitle">{{ getSubtitle() }}</span>
    </div>
  </div>

  <div class="header-actions">
    <button class="action-btn" (click)="onVoiceCall()" title="Appel vocal">
      ğŸ“
    </button>
    <button class="action-btn" (click)="onVideoCall()" title="Appel vidÃ©o">
      ğŸ“¹
    </button>
    <button class="action-btn" (click)="toggleInfo()" title="Informations">
      â„¹ï¸
    </button>
  </div>

  <!-- Panel d'information -->
  <div class="info-panel" *ngIf="showInfo" [@slideDown]="showInfo ? 'open' : 'closed'">
    <div class="info-header">
      <h4>Informations</h4>
      <button class="close-btn" (click)="toggleInfo()">âœ•</button>
    </div>
    
    <div class="info-content">
      <div class="info-section">
        <h5>Type de conversation</h5>
        <p>{{ getConversationTypeText() }}</p>
      </div>
      
      <div class="info-section" *ngIf="conversation.skillId">
        <h5>CompÃ©tence liÃ©e</h5>
        <p>ID: {{ conversation.skillId }}</p>
      </div>
      
      <div class="info-section">
        <h5>Participants ({{ conversation.participants.length }})</h5>
        <div class="participants-list">
          <div *ngFor="let participant of conversation.participants" class="participant-item">
            <!-- âœ… CORRECTION: Utiliser getParticipantAvatar() au lieu de participant.avatarUrl -->
            <img [src]="getParticipantAvatar(participant)" [alt]="participant.userName">
            <span class="participant-name">{{ participant.userName }}</span>
            <span class="participant-role" *ngIf="participant.role === 'ADMIN'">Admin</span>
            <span class="participant-status" [class.online]="participant.isOnline">
              {{ participant.isOnline ? 'â—' : 'â—‹' }}
            </span>
          </div>
        </div>
      </div>

      <div class="info-section" *ngIf="conversation.status">
        <h5>Statut</h5>
        <p>
          <span class="status-indicator" [style.color]="getStatusColor()">â—</span>
          {{ getStatusText() }}
        </p>
      </div>

      <div class="info-section" *ngIf="conversation.createdAt">
        <h5>CrÃ©Ã©e le</h5>
        <p>{{ formatDate(conversation.createdAt) }}</p>
      </div>

      <div class="info-section" *ngIf="canManageConversation()">
        <h5>Actions</h5>
        <div class="action-buttons">
          <button class="info-action-btn" (click)="onSearchInConversation()">
            ğŸ” Rechercher dans la conversation
          </button>
          <button class="info-action-btn" (click)="onMuteConversation()">
            ğŸ”‡ Notifications
          </button>
          <button class="info-action-btn" *ngIf="!isDirectConversation()" (click)="onManageParticipants()">
            ğŸ‘¥ GÃ©rer les participants
          </button>
          <button class="info-action-btn" *ngIf="isGroupConversation()" (click)="onLeaveConversation()">
            ğŸšª Quitter le groupe
          </button>
          <button class="info-action-btn danger" (click)="onArchiveConversation()">
            ğŸ“ Archiver la conversation
          </button>
        </div>
      </div>
    </div>
  </div>
</header>