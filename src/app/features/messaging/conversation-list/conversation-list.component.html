<div class="conversation-list">
  <div 
    *ngFor="let conversation of conversations" 
    class="conversation-item"
    [class.active]="selectedConversation?.id === conversation.id"
    [class.has-unread]="conversation.unreadCount > 0"
    (click)="selectConversation(conversation)"
  >
    <div class="conversation-avatar">
      <img *ngIf="getConversationAvatar(conversation)" 
           [src]="getConversationAvatar(conversation)" 
           [alt]="conversation.name"
           class="conversation-image">
      
      <!-- Online/Offline indicator for direct conversations -->
      <div *ngIf="conversation.type === 'DIRECT'" class="status-indicator">
        <span class="status-dot" 
              [class.online]="isDirectConversationOnline(conversation)"
              [class.offline]="!isDirectConversationOnline(conversation)">
        </span>
      </div>
    </div>
    
    <div class="conversation-info">
      <div class="conversation-header">
        <h4 class="conversation-name">
          <span class="conversation-icon">{{ getConversationIcon(conversation) }}</span>
          {{ getConversationName(conversation) }}
        </h4>
        <span class="conversation-time">{{ formatLastMessageTime(conversation.lastMessageTime) }}</span>
      </div>
      
      <div class="conversation-preview">
        <div class="message-status-wrapper">
          <p class="last-message">{{ conversation.lastMessage || 'Aucun message' }}</p>
          
          <!-- Status text based on conversation type -->
          <small class="status-text" 
                 [class.online]="conversation.type === 'DIRECT' && isDirectConversationOnline(conversation)">
            <span *ngIf="conversation.type === 'DIRECT'">
              {{ getDirectConversationStatus(conversation) }}
            </span>
            <span *ngIf="conversation.type === 'GROUP' || conversation.type === 'SKILL_GROUP'">
              {{ getGroupStatusText(conversation) }}
            </span>
          </small>
        </div>
        
        <span class="unread-badge" *ngIf="conversation.unreadCount > 0">
          {{ conversation.unreadCount > 99 ? '99+' : conversation.unreadCount }}
        </span>
      </div>
    </div>
  </div>

  <div *ngIf="conversations.length === 0" class="no-conversations">
    <span class="empty-icon">ðŸ“­</span>
    <p>Aucune conversation</p>
    <small>Commencez une nouvelle conversation</small>
  </div>
</div>