<div class="skills-container">
 
  
  <mat-progress-bar *ngIf="isLoading" mode="indeterminate"></mat-progress-bar>
  
  <div *ngIf="error" class="error-message">
    <mat-icon>error</mat-icon> {{ error }}
  </div>
  
  <div *ngIf="!isLoading && !error">
    <div *ngIf="skills.length === 0" class="no-skills">
      <img src="assets/images/default-skills.png" alt="Aucune comp√©tence" class="empty-state-img">
      <p>Vous n'avez pas encore de comp√©tences accept√©es en cours.</p>
      <small>Les comp√©tences appara√Ætront ici une fois accept√©es par les producteurs</small>
    </div>
    
    <div class="skills-grid">
      <mat-card *ngFor="let skill of skills" class="skill-card">
        <div class="skill-image-container">
          <img [src]="skill.pictureUrl || 'assets/images/default-skills.png'" 
               alt="{{ skill.name }}" 
               class="skill-image">
          
          <!-- Status chip overlay -->
          <div class="status-overlay" *ngIf="skill.exchangeStatus">
            <mat-chip [color]="getStatusColor(skill.exchangeStatus)" selected>
              {{ getStatusLabel(skill.exchangeStatus) }}
            </mat-chip>
          </div>
          
          <!-- Livestream Status chip overlay -->
          <div class="session-overlay" *ngIf="sessions[skill.id]">
            <mat-chip [color]="sessions[skill.id].status === 'LIVE' ? 'warn' : 'accent'" selected>
              {{ sessions[skill.id].status === 'LIVE' ? 'EN DIRECT' : 'PROGRAMM√â' }}
            </mat-chip>
          </div>
        </div>
        
        <mat-card-content>
          <h3>{{ skill.name }}</h3>
          <span class="skill-category">{{ skill.categoryName }}</span>
          <p class="skill-description" 
             [class.expanded]="skill.showFullDescription"
             [class.expandable]="skill.description.length > 100">
            <span class="description-text">
              {{ skill.showFullDescription ? skill.description : ((skill.description.length > 100) ? (skill.description | slice:0:100) + '...' : skill.description) }}
            </span>
            <button *ngIf="skill.description.length > 100" 
                    class="expand-btn"
                    (click)="toggleDescription(skill)"
                    mat-button>
              {{ skill.showFullDescription ? 'Voir moins' : 'Voir plus' }}
            </button>
          </p>
          
          <!-- REMPLACER la section skill-meta dans accepted-skills.component.html -->
<div class="skill-meta">
  <div class="single-meta-row">
    <!-- Participants -->
    <div class="meta-item">
      <mat-icon>people</mat-icon>
      <span>{{ skill.nbInscrits }}/{{ skill.availableQuantity }}</span>
    </div>

    <!-- Date -->
    <div class="meta-item">
      <mat-icon>calendar_today</mat-icon>
      <span>{{ skill.streamingDate | date:'dd/MM/yy' }}</span>
    </div>

    <!-- Heure -->
    <div class="meta-item">
      <mat-icon>access_time</mat-icon>
      <span>{{ skill.streamingTime }}</span>
    </div>

    <!-- Prix -->
    <div class="meta-item price">
      <span>TND {{ skill.price | number:'1.2-2' }}</span>
    </div>
  </div>
</div>
          
          <!-- Exchange Status Display - CACH√â pour l'utilisateur -->
          <div class="exchange-status" *ngIf="skill.exchangeStatus" style="display: none;">
            <div class="status-info">
              <mat-icon>swap_horiz</mat-icon>
              <span>Statut de l'√©change: </span>
              <mat-chip [color]="getStatusColor(skill.exchangeStatus)" selected>
                {{ getStatusLabel(skill.exchangeStatus) }}
              </mat-chip>
            </div>
          </div>
          
          <!-- Session Status Display -->
          <div class="session-status" *ngIf="sessions[skill.id]">
            <div class="session-info">
              <mat-icon>live_tv</mat-icon>
              <span>Session: </span>
              <mat-chip [color]="sessions[skill.id].status === 'LIVE' ? 'primary' : 'accent'" selected>
                {{ sessions[skill.id].status === 'LIVE' ? 'En direct' : 'Programm√©e' }}
              </mat-chip>
              <span class="session-time" *ngIf="sessions[skill.id].startTime">
                - {{ sessions[skill.id].startTime | date:'HH:mm' }}
              </span>
            </div>
          </div>
          
          <div class="producer-info">
            <span>Propos√© par : </span>
            <a (click)="openProducerProfile(skill.userId)" class="producer-link">
              {{ getProducerName(skill.userId) }}
            </a>
          </div>
        </mat-card-content>
        
        <mat-card-actions>
          <!-- Livestream Join Button -->
          <button mat-raised-button 
                  color="primary"
                  *ngIf="canJoinLivestream(skill)"
                  (click)="joinLivestreamSession(skill)"
                  class="join-livestream-btn"
                  [disabled]="isLoading">
            <mat-icon>play_circle_filled</mat-icon>
            {{ sessions[skill.id].status === 'LIVE' ? 'Rejoindre Live' : 'Rejoindre Session' }}
          </button>
          
          <!-- Status-based action buttons - üéØ EXCLU LES STATUS COMPLETED -->
          <div class="status-actions" *ngIf="skill.exchangeStatus && !canJoinLivestream(skill)">
            <ng-container [ngSwitch]="skill.exchangeStatus">
              
              <!-- Pending Status -->
              <div *ngSwitchCase="'PENDING'" class="pending-status">
                <mat-icon color="accent">hourglass_empty</mat-icon>
                <span>En attente de validation du producteur</span>
              </div>
              
              <!-- Accepted Status (but no live session) -->
              <div *ngSwitchCase="'ACCEPTED'" class="accepted-status">
                <mat-icon color="primary">check_circle</mat-icon>
                <span>{{ sessions[skill.id] ? 'Session programm√©e' : 'En attente de session' }}</span>
              </div>
              
              <!-- In Progress Status -->
              <div *ngSwitchCase="'IN_PROGRESS'" class="in-progress-status">
                <mat-icon color="primary">play_arrow</mat-icon>
                <span>Session en cours</span>
              </div>
              
              <!-- Rejected Status -->
              <div *ngSwitchCase="'REJECTED'" class="rejected-status">
                <mat-icon color="warn">cancel</mat-icon>
                <span>Demande rejet√©e</span>
              </div>
              
              <!-- Cancelled Status -->
              <div *ngSwitchCase="'CANCELLED'" class="cancelled-status">
                <mat-icon color="warn">block</mat-icon>
                <span>Session annul√©e</span>
              </div>
              
            </ng-container>
          </div>
        </mat-card-actions>

        <!-- üö´ RATING DISPLAY SUPPRIM√â - Maintenant uniquement dans finished-skills -->
        
      </mat-card>
    </div>
  </div>
</div>