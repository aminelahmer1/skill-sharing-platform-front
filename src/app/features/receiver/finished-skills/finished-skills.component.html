<div class="skills-container">
  
  <mat-progress-bar *ngIf="isLoading" mode="indeterminate"></mat-progress-bar>
  
  <div *ngIf="error" class="error-message">
    <mat-icon>error</mat-icon> {{ error }}
  </div>
  
  <div *ngIf="!isLoading && !error">
    <div *ngIf="skills.length === 0" class="no-skills">
      <img src="assets/images/default-skills.png" alt="Aucune comp√©tence termin√©e" class="empty-state-img">
      <p>Vous n'avez pas encore de comp√©tences termin√©es.</p>
      <small>Les comp√©tences appara√Ætront ici apr√®s avoir termin√© vos sessions</small>
    </div>
    
    <div class="skills-grid">
      <mat-card *ngFor="let skill of skills; trackBy: trackBySkillId" 
                class="skill-card" 
                [class.session-completed]="true">
        <div class="skill-image-container">
          <img [src]="skill.pictureUrl || 'assets/images/default-skills.png'" 
               alt="{{ skill.name }}" 
               class="skill-image">
          
          <!-- Status chip overlay - Toujours "Termin√©" -->
          <div class="status-overlay">
            <mat-chip color="primary" selected>
              Termin√©
            </mat-chip>
          </div>
        </div>
        
        <mat-card-content>
          <!-- üîß FIX - TITRE LIMIT√â √Ä 3 LIGNES -->
          <h3>{{ skill.name }}</h3>
          
          <span class="skill-category">{{ skill.categoryName }}</span>
          
          <!-- üîß FIX - DESCRIPTION LIMIT√âE √Ä 10 LIGNES AVEC EXPAND/COLLAPSE -->
          <p class="skill-description" 
             [class.expanded]="skill.showFullDescription"
             [class.expandable]="skill.description.length > 100">
            <span class="description-text">
              {{ skill.showFullDescription ? skill.description : ((skill.description.length > 100) ? (skill.description | slice:0:100) + '...' : skill.description) }}
            </span>
            <button *ngIf="skill.description.length > 100" 
                    class="expand-btn"
                    (click)="toggleDescription(skill)"
                    mat-button>
              {{ skill.showFullDescription ? 'Voir moins' : 'Voir plus' }}
            </button>
          </p>
          
          <!-- M√©tadonn√©es sur une seule ligne comme my-livestreams -->
          <div class="skill-meta">
            <div class="single-meta-row">
              <!-- Participants -->
              <div class="meta-item">
                <mat-icon>people</mat-icon>
                <span>{{ skill.nbInscrits }}/{{ skill.availableQuantity }}</span>
              </div>

              <!-- Date -->
              <div class="meta-item">
                <mat-icon>calendar_today</mat-icon>
                <span>{{ skill.streamingDate | date:'dd/MM/yy' }}</span>
              </div>

              <!-- Heure -->
              <div class="meta-item">
                <mat-icon>access_time</mat-icon>
                <span>{{ skill.streamingTime }}</span>
              </div>

              <!-- Prix -->
              <div class="meta-item price">
                <span>TND {{ skill.price | number:'1.2-2' }}</span>
              </div>
            </div>
          </div>
          
          <!-- Producer info compacte -->
          <div class="producer-info">
            <span>Propos√© par : </span>
            <a (click)="openProducerProfile(skill.userId)" class="producer-link">
              {{ getProducerName(skill.userId) }}
            </a>
            
            <!-- Section Rating compacte comme my-livestreams -->
            <div class="skill-rating-compact" *ngIf="skill.hasRated">
              <div class="rating-summary">
                <mat-icon>star</mat-icon>
                <span class="rating-label">Votre note:</span>
                <div class="rating-value">
                  <span class="rating-number" [style.color]="getRatingColor(skill.currentRating!)">
                    {{ skill.currentRating | number:'1.1-1' }}
                  </span>
                  <span class="rating-count">/5</span>
                  
                  <!-- Affichage des √©toiles mini -->
                  <div class="stars-mini">
                    <mat-icon *ngFor="let star of getStarArray(skill.currentRating!)" 
                              [class.filled]="star"
                              class="star-icon-mini">
                      {{ star ? 'star' : 'star_border' }}
                    </mat-icon>
                  </div>
                </div>
                
                <!-- Bouton pour voir les d√©tails -->
                <button mat-stroked-button 
                        color="primary" 
                        class="view-rating-btn"
                        (click)="viewMyRating(skill)">
                  <mat-icon>visibility</mat-icon>
                  Voir d√©tails
                </button>
              </div>
            </div>
            
            <!-- Prompt d'√©valuation compact -->
            <div class="rating-prompt-compact" *ngIf="!skill.hasRated">
              <button mat-raised-button 
                      color="primary" 
                      class="rate-compact-btn"
                      (click)="openRatingDialog(skill)">
                <mat-icon>star_rate</mat-icon>
                √âvaluer
              </button>
            </div>
          </div>
        </mat-card-content>
        
        <mat-card-actions>
          <!-- Badge session termin√©e centr√© -->
          <div class="session-completed-badge">
            <mat-icon>check_circle</mat-icon>
            <span>Session termin√©e</span>
          </div>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>