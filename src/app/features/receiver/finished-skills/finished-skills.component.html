<div class="skills-container">
  <div class="header-section">
    
    
    <!-- üìä Info pagination en haut -->
    <div *ngIf="!isLoading && !error && totalItems > 0" class="pagination-info">
      <div class="total-info">
        <mat-icon>check_circle</mat-icon>
        <span>{{ totalItems }} comp√©tence(s) termin√©e(s)</span>
      </div>
      <div class="page-info">
        <span>{{ getCurrentPageInfo() }}</span>
      </div>
    </div>
  </div>
  
  <mat-progress-bar *ngIf="isLoading" mode="indeterminate"></mat-progress-bar>
  
  <div *ngIf="error" class="error-message">
    <mat-icon>error</mat-icon> {{ error }}
  </div>
  
  <div *ngIf="!isLoading && !error">
    <div *ngIf="totalItems === 0" class="no-skills">
      <img src="assets/images/default-skills.png" alt="Aucune comp√©tence termin√©e" class="empty-state-img">
      <p>Vous n'avez pas encore de comp√©tences termin√©es.</p>
      <small>Les comp√©tences appara√Ætront ici apr√®s avoir termin√© vos sessions livestream</small>
    </div>
    
    <div class="skills-grid">
      <mat-card *ngFor="let skill of skills; trackBy: trackBySkillId" class="skill-card">
        <div class="skill-image-container">
          <img [src]="skill.pictureUrl || 'assets/images/default-skills.png'" 
               alt="{{ skill.name }}" 
               class="skill-image">
          
          <!-- Status chip overlay - Toujours "Termin√©" -->
          <div class="status-overlay">
            <mat-chip [color]="getStatusColor(skill.exchangeStatus)" selected>
              {{ getStatusLabel(skill.exchangeStatus) }}
            </mat-chip>
          </div>
        </div>
        
        <mat-card-content>
          <h3>{{ skill.name }}</h3>
          <span class="skill-category">{{ skill.categoryName }}</span>
          <p class="skill-description" 
             [class.expanded]="skill.showFullDescription"
             [class.expandable]="skill.description.length > 100">
            <span class="description-text">
              {{ skill.showFullDescription ? skill.description : ((skill.description.length > 100) ? (skill.description | slice:0:100) + '...' : skill.description) }}
            </span>
            <button *ngIf="skill.description.length > 100" 
                    class="expand-btn"
                    (click)="toggleDescription(skill)"
                    mat-button>
              {{ skill.showFullDescription ? 'Voir moins' : 'Voir plus' }}
            </button>
          </p>
          
         <div class="skill-meta">
  <div class="single-meta-row">
    <!-- Participants -->
    <div class="meta-item">
      <mat-icon>people</mat-icon>
      <span>{{ skill.nbInscrits }}/{{ skill.availableQuantity }}</span>
    </div>

    <!-- Date -->
    <div class="meta-item">
      <mat-icon>calendar_today</mat-icon>
      <span>{{ skill.streamingDate | date:'dd/MM/yy' }}</span>
    </div>

    <!-- Heure -->
    <div class="meta-item">
      <mat-icon>access_time</mat-icon>
      <span>{{ skill.streamingTime }}</span>
    </div>

    <!-- Prix -->
    <div class="meta-item price">
      <span>TND {{ skill.price | number:'1.2-2' }}</span>
    </div>
  </div>
</div>
          
          <div class="producer-info">
            <span>Propos√© par : </span>
            <a (click)="openProducerProfile(skill.userId)" class="producer-link">
              {{ getProducerName(skill.userId) }}
            </a>
          </div>
        </mat-card-content>
        
        <!-- üéØ PAS D'ACTIONS - Comp√©tences termin√©es uniquement -->
        <mat-card-actions style="display: none;">
          <!-- Pas de boutons d'action pour les comp√©tences termin√©es -->
        </mat-card-actions>

        <!-- üéØ RATING DISPLAY - Toujours affich√© pour les comp√©tences termin√©es -->
        <div class="rating-section-bottom">
          <!-- Composant de rating EN HAUT -->
          <app-rating-display 
            [exchangeId]="skill.exchangeId"
            [status]="skill.exchangeStatus"
            [skillName]="skill.name"
            [producerName]="getProducerName(skill.userId)"
            (ratingUpdated)="onRatingUpdated(skill)">
          </app-rating-display>
          
          <!-- Badge "Session termin√©e" EN BAS -->
          <div class="session-completed-badge">
            <mat-icon>check_circle</mat-icon>
            <span>Session termin√©e</span>
          </div>
        </div>
      </mat-card>
    </div>
    
    <!-- üìÑ Pagination principale en bas -->
    <div *ngIf="totalItems > 0" class="pagination-bottom">
      <mat-paginator
        [length]="totalItems"
        [pageSize]="pageSize"
        [pageSizeOptions]="pageSizeOptions"
        [pageIndex]="currentPage"
        (page)="onPageChange($event)"
        showFirstLastButtons>
      </mat-paginator>
      
      <!-- Info suppl√©mentaire -->
      <div class="pagination-summary">
        <span>Page {{ currentPage + 1 }} sur {{ getTotalPages() }}</span>
        <span class="separator">‚Ä¢</span>
        <span>{{ pageSize }} par page</span>
      </div>
    </div>
  </div>
</div>